<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CosmicFish: /media/psf/Home/Desktop/COSMICFISH/0_cosmicfish_public/cosmicfish/sources/008_Fisher_calculator_Cls_windows.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CosmicFish_Icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CosmicFish
   &#160;<span id="projectnumber">Reference documentation for version 1.0</span>
   </div>
   <div id="projectbrief">Looking into future Cosmology</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_08d237fc27d4ecd563f71c5d52f2fecc.html">sources</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">008_Fisher_calculator_Cls_windows.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="008__Fisher__calculator__Cls__windows_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">! This file is part of CosmicFish.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">! Copyright (C) 2015-2016 by the CosmicFish authors</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! The CosmicFish code is free software;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! You can use it, redistribute it, and/or modify it under the terms</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">! of the GNU General Public License as published by the Free Software Foundation;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">! either version 3 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">! The full text of the license can be found in the file LICENSE at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">! the top level of the CosmicFish distribution.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html">   26</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacefisher__calculator__cls__windows.html">fisher_calculator_cls_windows</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">use </span>precision</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">use </span>constants<span class="keywordtype">, only</span>: const_pi</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">use </span>redshiftspacedata</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacecosmicfish__types.html">cosmicfish_types</a></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structcosmicfish__types_1_1cosmicfish__params.html">cosmicfish_params</a>), <span class="keywordtype">save</span> :: window_fp</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">private</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">public</span> <a class="code" href="namespacefisher__calculator__cls__windows.html#ac9e7094044d99ca89b95a6ce85042000">init_camb_sources_windows</a>, <a class="code" href="namespacefisher__calculator__cls__windows.html#a47bcfd3d5d53bc68c599fc48865dede1">gaussian_window</a>, <a class="code" href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">bin_window</a>, <a class="code" href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">flat_window</a>, <a class="code" href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">flat_smooth_window</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">! ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">    subroutine </span><a class="code" href="namespacefisher__calculator__cls__windows.html#ac9e7094044d99ca89b95a6ce85042000">init_camb_sources_windows</a>( FP )</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html#ac9e7094044d99ca89b95a6ce85042000">   48</a></span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordtype">Type</span>(<a class="code" href="structcosmicfish__types_1_1cosmicfish__params.html">cosmicfish_params</a>), <span class="keywordtype">intent(in)</span>  :: FP</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        window_fp = fp</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> ( fp%fisher_cls%window_type == 1 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            window_function_calc =&gt; default_window</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fp%fisher_cls%window_type == 2 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            window_function_calc =&gt; <a class="code" href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">bin_window</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fp%fisher_cls%window_type == 3 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            window_function_calc =&gt; <a class="code" href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">flat_window</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fp%fisher_cls%window_type == 4 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            window_function_calc =&gt; <a class="code" href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">flat_smooth_window</a></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            window_function_calc =&gt; null()</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacefisher__calculator__cls__windows.html#ac9e7094044d99ca89b95a6ce85042000">init_camb_sources_windows</a></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">! ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">    function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#a47bcfd3d5d53bc68c599fc48865dede1">gaussian_window</a>(Win, z, winamp)</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html#a47bcfd3d5d53bc68c599fc48865dede1">   74</a></span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">Type</span>(tredwin)        :: Win</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">real(dl)</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">real(dl)</span>             :: winamp</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">real(dl)</span> :: gaussian_window</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">real(dl)</span> :: dz</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        gaussian_window = 0._dl</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        dz     = z - win%Redshift</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        winamp =  exp(-0.5_dl*(dz/win%sigma)**2)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        gaussian_window = winamp/win%sigma/sqrt(2._dl*const_pi)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">    end function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#a47bcfd3d5d53bc68c599fc48865dede1">gaussian_window</a></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">! ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">    function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">bin_window</a>(Win, z, winamp)</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">   97</a></span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordtype">Type</span>(tredwin)        :: Win</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordtype">real(dl)</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordtype">real(dl)</span>             :: winamp</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">real(dl)</span> :: bin_window</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">real(dl)</span> :: alpha, beta, z0, sigma, total_number_z</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        alpha = window_fp%fisher_cls%window_alpha</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        beta  = window_fp%fisher_cls%window_beta</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        z0    = window_fp%fisher_cls%redshift_zero</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        sigma = window_fp%fisher_cls%photoz_error*(1._dl+z)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        total_number_z = beta*z**alpha*exp(-(z/z0)**beta)/(z0**(alpha+1._dl))/gamma((alpha+1._dl)/beta)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        winamp = 0.5_dl*total_number_z*( &amp;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            &amp; +erf( (win%Redshift + win%sigma - z)/(sqrt(2._dl))/sigma ) &amp;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            &amp; -erf( (win%Redshift - z)/(sqrt(2._dl))/sigma ) )</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span> ( winamp&lt;1.d-10 ) winamp = 0._dl</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        bin_window = winamp</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">    end function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">bin_window</a></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">! ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">    function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">flat_window</a>(Win, z, winamp)</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">  129</a></span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">Type</span>(tredwin)        :: Win</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">real(dl)</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">real(dl)</span>             :: winamp</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">real(dl)</span> :: flat_window</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">real(dl)</span> :: alpha, beta, z0, sigma, total_number_z</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        winamp = 0._dl</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> ( win%Redshift&lt;z .and. z&lt;win%Redshift + win%sigma ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            winamp = 1._dl</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        flat_window = winamp</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keyword">    end function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">flat_window</a></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">! ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">    function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">flat_smooth_window</a>(Win, z, winamp)</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">  154</a></span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">Type</span>(tredwin)        :: Win</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">real(dl)</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">real(dl)</span>             :: winamp</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">real(dl)</span> :: flat_smooth_window</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordtype">real(dl)</span> :: alpha, beta, z0, sigma, total_number_z</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        winamp = 0._dl</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> ( win%Redshift&lt;z .and. z&lt;win%Redshift + win%sigma ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            winamp = 1._dl</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        sigma = window_fp%fisher_cls%photoz_error*(1._dl+z)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        winamp = 0.5_dl*winamp*( &amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            &amp; +erf( (win%Redshift + win%sigma - z)/(sqrt(2._dl))/sigma ) &amp;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            &amp; -erf( (win%Redshift - z)/(sqrt(2._dl))/sigma ) )</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> ( winamp&lt;1.d-10 ) winamp = 0._dl</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        flat_smooth_window = winamp</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">    end function </span><a class="code" href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">flat_smooth_window</a></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacefisher__calculator__cls__windows.html">fisher_calculator_cls_windows</a></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html_a47bcfd3d5d53bc68c599fc48865dede1"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html#a47bcfd3d5d53bc68c599fc48865dede1">fisher_calculator_cls_windows::gaussian_window</a></div><div class="ttdeci">real(dl) function, public gaussian_window(Win, z, winamp)</div><div class="ttdoc">This function computes a gaussian window function. Note this is the total count distribution observed...</div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00074">008_Fisher_calculator_Cls_windows.f90:74</a></div></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html_ad264f3215a0c879aebf735c845bda048"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html#ad264f3215a0c879aebf735c845bda048">fisher_calculator_cls_windows::flat_smooth_window</a></div><div class="ttdeci">real(dl) function, public flat_smooth_window(Win, z, winamp)</div><div class="ttdoc">This function computes a flat binned window function smoothed by photo z errors. For more details ref...</div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00154">008_Fisher_calculator_Cls_windows.f90:154</a></div></div>
<div class="ttc" id="namespacecosmicfish__types_html"><div class="ttname"><a href="namespacecosmicfish__types.html">cosmicfish_types</a></div><div class="ttdoc">This module contains the definitions of derived data types used to store the informations about the f...</div><div class="ttdef"><b>Definition:</b> <a href="004__cosmicfish__types_8f90_source.html#l00026">004_cosmicfish_types.f90:26</a></div></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html">fisher_calculator_cls_windows</a></div><div class="ttdoc">This module contains the definition of the window functions that are used by CAMB sources...</div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00026">008_Fisher_calculator_Cls_windows.f90:26</a></div></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html_aaeda92398d603d8ea38db6a28d474419"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html#aaeda92398d603d8ea38db6a28d474419">fisher_calculator_cls_windows::bin_window</a></div><div class="ttdeci">real(dl) function, public bin_window(Win, z, winamp)</div><div class="ttdoc">This function computes a Gaussian smoothed binned window. For more details refer to the documentation...</div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00097">008_Fisher_calculator_Cls_windows.f90:97</a></div></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html_ac9e7094044d99ca89b95a6ce85042000"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html#ac9e7094044d99ca89b95a6ce85042000">fisher_calculator_cls_windows::init_camb_sources_windows</a></div><div class="ttdeci">subroutine, public init_camb_sources_windows(FP)</div><div class="ttdoc">This function initialises the camb sources number counts and lensing window function. The default is the gaussian window that is included in camb sources. If another window is chosen it will be initialised by the CosmicFish value. </div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00048">008_Fisher_calculator_Cls_windows.f90:48</a></div></div>
<div class="ttc" id="namespacefisher__calculator__cls__windows_html_a68ed201096f6fa3b29f1c5d36ed975c8"><div class="ttname"><a href="namespacefisher__calculator__cls__windows.html#a68ed201096f6fa3b29f1c5d36ed975c8">fisher_calculator_cls_windows::flat_window</a></div><div class="ttdeci">real(dl) function, public flat_window(Win, z, winamp)</div><div class="ttdoc">This function computes a flat binned window. For more details refer to the documentation. </div><div class="ttdef"><b>Definition:</b> <a href="008__Fisher__calculator__Cls__windows_8f90_source.html#l00129">008_Fisher_calculator_Cls_windows.f90:129</a></div></div>
<div class="ttc" id="structcosmicfish__types_1_1cosmicfish__params_html"><div class="ttname"><a href="structcosmicfish__types_1_1cosmicfish__params.html">cosmicfish_types::cosmicfish_params</a></div><div class="ttdoc">This derived data type contains all the informations that the cosmicfish code needs to run...</div><div class="ttdef"><b>Definition:</b> <a href="004__cosmicfish__types_8f90_source.html#l00215">004_cosmicfish_types.f90:215</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 21 2016 03:18:43 for CosmicFish by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
